Start first sampling
sample_global_test has shape (200, 3)
val_global_test has shape (200, 4)
sample_train has shape (500, 3)
val_train has shape (500, 4)
sample_test has shape (1000000, 3)
val_test has shape (1000000, 4)
Start first training
X_train: torch.Size([500, 4]), y_train: torch.Size([500, 3]), X_test: torch.Size([1000000, 4]), y_test: torch.Size([1000000, 3]), X_global_test: torch.Size([200, 4]), y_global_test: torch.Size([200, 3])
Epoch = 10, Average train loss:      0.18032841
Epoch = 10, Average test loss:      0.17984447
Epoch = 20, Average train loss:      0.10592533
Epoch = 20, Average test loss:      0.10707767
Epoch = 30, Average train loss:      0.05532247
Epoch = 30, Average test loss:      0.05814260
Epoch = 40, Average train loss:      0.04040408
Epoch = 40, Average test loss:      0.04465437
Epoch = 50, Average train loss:      0.03502453
Epoch = 50, Average test loss:      0.03631824
Epoch = 60, Average train loss:      0.03322713
Epoch = 60, Average test loss:      0.03694233
Epoch = 70, Average train loss:      0.03193016
Epoch = 70, Average test loss:      0.03313560
Epoch = 80, Average train loss:      0.03049798
Epoch = 80, Average test loss:      0.03255034
Epoch = 90, Average train loss:      0.02887514
Epoch = 90, Average test loss:      0.03135528
Epoch = 100, Average train loss:      0.02791956
Epoch = 100, Average test loss:      0.03275981
Epoch = 110, Average train loss:      0.02672481
Epoch = 110, Average test loss:      0.03129672
Epoch = 120, Average train loss:      0.02634646
Epoch = 120, Average test loss:      0.02945570
Epoch = 130, Average train loss:      0.02584789
Epoch = 130, Average test loss:      0.02964317
Epoch = 140, Average train loss:      0.02431942
Epoch = 140, Average test loss:      0.02869277
Epoch = 150, Average train loss:      0.02296583
Epoch = 150, Average test loss:      0.02793106
Epoch = 160, Average train loss:      0.02187759
Epoch = 160, Average test loss:      0.02515879
Epoch = 170, Average train loss:      0.02094931
Epoch = 170, Average test loss:      0.02502885
Epoch = 180, Average train loss:      0.01994438
Epoch = 180, Average test loss:      0.02392323
Epoch = 190, Average train loss:      0.01909793
Epoch = 190, Average test loss:      0.02278937
Epoch = 200, Average train loss:      0.01808562
Epoch = 200, Average test loss:      0.02135098
Epoch = 210, Average train loss:      0.01746251
Epoch = 210, Average test loss:      0.02139130
Epoch = 220, Average train loss:      0.01672022
Epoch = 220, Average test loss:      0.02146525
Epoch = 230, Average train loss:      0.01751893
Epoch = 230, Average test loss:      0.02095379
Epoch = 240, Average train loss:      0.01606810
Epoch = 240, Average test loss:      0.01895020
Epoch = 250, Average train loss:      0.01546222
Epoch = 250, Average test loss:      0.02022387
Epoch = 260, Average train loss:      0.01506225
Epoch = 260, Average test loss:      0.01914977
Epoch = 270, Average train loss:      0.01419254
Epoch = 270, Average test loss:      0.01915731
Epoch = 280, Average train loss:      0.01358223
Epoch = 280, Average test loss:      0.01932834
Epoch = 290, Average train loss:      0.01318745
Epoch = 290, Average test loss:      0.01904312
Epoch = 300, Average train loss:      0.01306421
Epoch = 300, Average test loss:      0.01796017
Epoch = 310, Average train loss:      0.01290578
Epoch = 310, Average test loss:      0.01868169
Epoch = 320, Average train loss:      0.01424548
Epoch = 320, Average test loss:      0.01933340
Epoch = 330, Average train loss:      0.01165079
Epoch = 330, Average test loss:      0.01657435
Epoch = 340, Average train loss:      0.01114189
Epoch = 340, Average test loss:      0.01568437
Epoch = 350, Average train loss:      0.01094341
Epoch = 350, Average test loss:      0.01525790
Epoch = 360, Average train loss:      0.01039693
Epoch = 360, Average test loss:      0.01641978
Epoch = 370, Average train loss:      0.00968820
Epoch = 370, Average test loss:      0.01549025
Epoch = 380, Average train loss:      0.00970402
Epoch = 380, Average test loss:      0.01583913
Epoch = 390, Average train loss:      0.00921245
Epoch = 390, Average test loss:      0.01502651
Epoch = 400, Average train loss:      0.00899331
Epoch = 400, Average test loss:      0.01498786
Epoch = 410, Average train loss:      0.00840706
Epoch = 410, Average test loss:      0.01523686
Epoch = 420, Average train loss:      0.00802723
Epoch = 420, Average test loss:      0.01512228
Epoch = 430, Average train loss:      0.00819349
Epoch = 430, Average test loss:      0.01473557
Epoch = 440, Average train loss:      0.00787818
Epoch = 440, Average test loss:      0.01494246
Epoch = 450, Average train loss:      0.00749105
Epoch = 450, Average test loss:      0.01543821
Epoch = 460, Average train loss:      0.00820008
Epoch = 460, Average test loss:      0.01399581
Epoch = 470, Average train loss:      0.00779297
Epoch = 470, Average test loss:      0.01476184
Epoch = 480, Average train loss:      0.00751547
Epoch = 480, Average test loss:      0.01353380
Epoch = 490, Average train loss:      0.00739696
Epoch = 490, Average test loss:      0.01346856
Epoch = 500, Average train loss:      0.00717479
Epoch = 500, Average test loss:      0.01356898
Epoch = 510, Average train loss:      0.00673366
Epoch = 510, Average test loss:      0.01211187
Epoch = 520, Average train loss:      0.00635552
Epoch = 520, Average test loss:      0.01276992
Epoch = 530, Average train loss:      0.00681901
Epoch = 530, Average test loss:      0.01240420
Epoch = 540, Average train loss:      0.00658717
Epoch = 540, Average test loss:      0.01245760
Epoch = 550, Average train loss:      0.00606150
Epoch = 550, Average test loss:      0.01255605
Epoch = 560, Average train loss:      0.00624323
Epoch = 560, Average test loss:      0.01240815
Epoch = 570, Average train loss:      0.00588319
Epoch = 570, Average test loss:      0.01113108
Epoch = 580, Average train loss:      0.00640917
Epoch = 580, Average test loss:      0.01162181
Epoch = 590, Average train loss:      0.00610410
Epoch = 590, Average test loss:      0.01151096
Epoch = 600, Average train loss:      0.00686754
Epoch = 600, Average test loss:      0.01238149
Epoch = 610, Average train loss:      0.00628252
Epoch = 610, Average test loss:      0.01322360
Epoch = 620, Average train loss:      0.00589656
Epoch = 620, Average test loss:      0.01136912
Epoch = 630, Average train loss:      0.00585993
Epoch = 630, Average test loss:      0.01147132
Epoch = 640, Average train loss:      0.00561122
Epoch = 640, Average test loss:      0.01057699
Epoch = 650, Average train loss:      0.00559686
Epoch = 650, Average test loss:      0.01195212
Epoch = 660, Average train loss:      0.00526885
Epoch = 660, Average test loss:      0.01171291
Epoch = 670, Average train loss:      0.00522727
Epoch = 670, Average test loss:      0.01155435
Epoch = 680, Average train loss:      0.00504495
Epoch = 680, Average test loss:      0.01021599
Epoch = 690, Average train loss:      0.00560455
Epoch = 690, Average test loss:      0.01140436
Epoch = 700, Average train loss:      0.00530611
Epoch = 700, Average test loss:      0.01167927
Epoch = 710, Average train loss:      0.00671771
Epoch = 710, Average test loss:      0.01342968
Epoch = 720, Average train loss:      0.00627015
Epoch = 720, Average test loss:      0.01360718
Epoch = 730, Average train loss:      0.00581039
Epoch = 730, Average test loss:      0.01100812
Epoch = 740, Average train loss:      0.00547057
Epoch = 740, Average test loss:      0.01155678
Epoch = 750, Average train loss:      0.00508984
Epoch = 750, Average test loss:      0.01016946
Epoch = 760, Average train loss:      0.00491440
Epoch = 760, Average test loss:      0.01083372
Epoch = 770, Average train loss:      0.00482655
Epoch = 770, Average test loss:      0.00987682
Epoch = 780, Average train loss:      0.00480151
Epoch = 780, Average test loss:      0.00999621
Epoch = 790, Average train loss:      0.00494108
Epoch = 790, Average test loss:      0.00940186
Epoch = 800, Average train loss:      0.00450176
Epoch = 800, Average test loss:      0.01041667
Epoch = 810, Average train loss:      0.00833723
Epoch = 810, Average test loss:      0.01273896
Epoch = 820, Average train loss:      0.00579768
Epoch = 820, Average test loss:      0.00966343
Epoch = 830, Average train loss:      0.00527038
Epoch = 830, Average test loss:      0.01094257
Epoch = 840, Average train loss:      0.00487380
Epoch = 840, Average test loss:      0.00964728
Epoch = 850, Average train loss:      0.00478929
Epoch = 850, Average test loss:      0.01065521
Epoch = 860, Average train loss:      0.00465878
Epoch = 860, Average test loss:      0.01033818
Epoch = 870, Average train loss:      0.00478818
Epoch = 870, Average test loss:      0.01087988
Epoch = 880, Average train loss:      0.00482321
Epoch = 880, Average test loss:      0.01152488
Epoch = 890, Average train loss:      0.00464246
Epoch = 890, Average test loss:      0.00961751
Epoch = 900, Average train loss:      0.00439356
Epoch = 900, Average test loss:      0.00915440
Epoch = 910, Average train loss:      0.00434951
Epoch = 910, Average test loss:      0.00984502
Epoch = 920, Average train loss:      0.00497806
Epoch = 920, Average test loss:      0.00942050
Epoch = 930, Average train loss:      0.00423419
Epoch = 930, Average test loss:      0.00922146
Epoch = 940, Average train loss:      0.00427853
Epoch = 940, Average test loss:      0.00956253
Epoch = 950, Average train loss:      0.00401928
Epoch = 950, Average test loss:      0.00921875
Epoch = 960, Average train loss:      0.00412179
Epoch = 960, Average test loss:      0.00903512
Epoch = 970, Average train loss:      0.00425487
Epoch = 970, Average test loss:      0.00911580
Epoch = 980, Average train loss:      0.00432050
Epoch = 980, Average test loss:      0.00957193
Epoch = 990, Average train loss:      0.00405440
Epoch = 990, Average test loss:      0.00879676
Epoch = 1000, Average train loss:      0.00377055
Epoch = 1000, Average test loss:      0.00876868
Final test: Average loss = 0.06693628503608122
[[7.47110844e-01 1.30751818e-01 8.06944251e-01 4.45845304e-03]
 [9.36907291e-01 6.06532097e-01 7.10359216e-01 9.19725338e-04]
 [7.13586628e-01 9.92807984e-01 3.41538250e-01 2.77818367e-03]
 ...
 [6.33732259e-01 6.95592701e-01 5.05683482e-01 1.28744554e-03]
 [9.14083242e-01 6.12825334e-01 3.14909607e-01 8.42632799e-05]
 [6.23072386e-01 6.80434465e-01 8.23537290e-01 1.54023143e-02]]
(1000000, 4)
Start second sampling
test_output has shape (1000000, 4)
sample_train has shape (489, 3)
val_train has shape (489, 4)
sample_test has shape (1000000, 3)
val_test has shape (1000000, 4)
Start second trainig
X_train: torch.Size([489, 4]), y_train: torch.Size([489, 3]), X_test: torch.Size([1000000, 4]), y_test: torch.Size([1000000, 3]), X_global_test: torch.Size([200, 4]), y_global_test: torch.Size([200, 3])
Epoch = 10, Average train loss:      0.08305525
Epoch = 10, Average test loss:      2.60331726
Epoch = 20, Average train loss:      0.03507013
Epoch = 20, Average test loss:      0.22948797
Epoch = 30, Average train loss:      0.02542495
Epoch = 30, Average test loss:      0.12034479
Epoch = 40, Average train loss:      0.02195279
Epoch = 40, Average test loss:      0.15083344
Epoch = 50, Average train loss:      0.01823523
Epoch = 50, Average test loss:      0.13478501
Epoch = 60, Average train loss:      0.01320487
Epoch = 60, Average test loss:      0.09604807
Epoch = 70, Average train loss:      0.01038611
Epoch = 70, Average test loss:      0.06464837
Epoch = 80, Average train loss:      0.00913087
Epoch = 80, Average test loss:      0.05934245
Epoch = 90, Average train loss:      0.00864431
Epoch = 90, Average test loss:      0.06072337
Epoch = 100, Average train loss:      0.00760251
Epoch = 100, Average test loss:      0.06211317
Epoch = 110, Average train loss:      0.00690856
Epoch = 110, Average test loss:      0.05724910
Epoch = 120, Average train loss:      0.00628666
Epoch = 120, Average test loss:      0.05845619
Epoch = 130, Average train loss:      0.00554548
Epoch = 130, Average test loss:      0.05877919
Epoch = 140, Average train loss:      0.00526706
Epoch = 140, Average test loss:      0.05389941
Epoch = 150, Average train loss:      0.00482231
Epoch = 150, Average test loss:      0.05563278
Epoch = 160, Average train loss:      0.00446918
Epoch = 160, Average test loss:      0.05227626
Epoch = 170, Average train loss:      0.00422590
Epoch = 170, Average test loss:      0.04855166
Epoch = 180, Average train loss:      0.00419914
Epoch = 180, Average test loss:      0.04815789
Epoch = 190, Average train loss:      0.00406043
Epoch = 190, Average test loss:      0.04767021
Epoch = 200, Average train loss:      0.00374572
Epoch = 200, Average test loss:      0.04477996
Epoch = 210, Average train loss:      0.00379504
Epoch = 210, Average test loss:      0.05077112
Epoch = 220, Average train loss:      0.00352260
Epoch = 220, Average test loss:      0.04980287
Epoch = 230, Average train loss:      0.00330580
Epoch = 230, Average test loss:      0.04297648
Epoch = 240, Average train loss:      0.00335101
Epoch = 240, Average test loss:      0.04036266
Epoch = 250, Average train loss:      0.00344415
Epoch = 250, Average test loss:      0.03789622
Epoch = 260, Average train loss:      0.00302260
Epoch = 260, Average test loss:      0.03822945
Epoch = 270, Average train loss:      0.00297705
Epoch = 270, Average test loss:      0.03716033
Epoch = 280, Average train loss:      0.00288094
Epoch = 280, Average test loss:      0.04343577
Epoch = 290, Average train loss:      0.00298559
Epoch = 290, Average test loss:      0.03857987
Epoch = 300, Average train loss:      0.00268567
Epoch = 300, Average test loss:      0.03932814
Epoch = 310, Average train loss:      0.00266433
Epoch = 310, Average test loss:      0.04052810
Epoch = 320, Average train loss:      0.00271454
Epoch = 320, Average test loss:      0.04210981
Epoch = 330, Average train loss:      0.00258022
Epoch = 330, Average test loss:      0.03646260
Epoch = 340, Average train loss:      0.00261474
Epoch = 340, Average test loss:      0.04095670
Epoch = 350, Average train loss:      0.00260971
Epoch = 350, Average test loss:      0.03723096
Epoch = 360, Average train loss:      0.00245200
Epoch = 360, Average test loss:      0.05111607
Epoch = 370, Average train loss:      0.00256482
Epoch = 370, Average test loss:      0.04496215
Epoch = 380, Average train loss:      0.00232753
Epoch = 380, Average test loss:      0.04543022
Epoch = 390, Average train loss:      0.00238560
Epoch = 390, Average test loss:      0.05202002
Epoch = 400, Average train loss:      0.00250935
Epoch = 400, Average test loss:      0.04064810
Epoch = 410, Average train loss:      0.00242210
Epoch = 410, Average test loss:      0.04742216
Epoch = 420, Average train loss:      0.00225017
Epoch = 420, Average test loss:      0.04514427
Epoch = 430, Average train loss:      0.00218978
Epoch = 430, Average test loss:      0.05019063
Epoch = 440, Average train loss:      0.00222473
Epoch = 440, Average test loss:      0.06008539
Epoch = 450, Average train loss:      0.00211327
Epoch = 450, Average test loss:      0.04213266
Epoch = 460, Average train loss:      0.00221310
Epoch = 460, Average test loss:      0.05579784
Epoch = 470, Average train loss:      0.00208825
Epoch = 470, Average test loss:      0.04282383
Epoch = 480, Average train loss:      0.00216127
Epoch = 480, Average test loss:      0.05336128
Epoch = 490, Average train loss:      0.00214276
Epoch = 490, Average test loss:      0.04257713
Epoch = 500, Average train loss:      0.00195417
Epoch = 500, Average test loss:      0.03750983
Epoch = 510, Average train loss:      0.00198607
Epoch = 510, Average test loss:      0.04258414
Epoch = 520, Average train loss:      0.00188158
Epoch = 520, Average test loss:      0.04165766
Epoch = 530, Average train loss:      0.00188823
Epoch = 530, Average test loss:      0.04372535
Epoch = 540, Average train loss:      0.00185581
Epoch = 540, Average test loss:      0.04281748
Epoch = 550, Average train loss:      0.00191942
Epoch = 550, Average test loss:      0.04483072
Epoch = 560, Average train loss:      0.00181063
Epoch = 560, Average test loss:      0.04380033
Epoch = 570, Average train loss:      0.00184274
Epoch = 570, Average test loss:      0.04819312
Epoch = 580, Average train loss:      0.00205577
Epoch = 580, Average test loss:      0.04254943
Epoch = 590, Average train loss:      0.00173541
Epoch = 590, Average test loss:      0.05544195
Epoch = 600, Average train loss:      0.00182478
Epoch = 600, Average test loss:      0.05240287
Epoch = 610, Average train loss:      0.00179404
Epoch = 610, Average test loss:      0.05297533
Epoch = 620, Average train loss:      0.00167949
Epoch = 620, Average test loss:      0.06164986
Epoch = 630, Average train loss:      0.00172736
Epoch = 630, Average test loss:      0.06091600
Epoch = 640, Average train loss:      0.00175438
Epoch = 640, Average test loss:      0.05499157
Epoch = 650, Average train loss:      0.00162561
Epoch = 650, Average test loss:      0.05144753
Epoch = 660, Average train loss:      0.00177142
Epoch = 660, Average test loss:      0.06002201
Epoch = 670, Average train loss:      0.00181396
Epoch = 670, Average test loss:      0.07050690
Epoch = 680, Average train loss:      0.00165669
Epoch = 680, Average test loss:      0.05283165
Epoch = 690, Average train loss:      0.00159138
Epoch = 690, Average test loss:      0.05461767
Epoch = 700, Average train loss:      0.00162854
Epoch = 700, Average test loss:      0.06383380
Epoch = 710, Average train loss:      0.00173384
Epoch = 710, Average test loss:      0.05617511
Epoch = 720, Average train loss:      0.00160808
Epoch = 720, Average test loss:      0.05313311
Epoch = 730, Average train loss:      0.00157531
Epoch = 730, Average test loss:      0.05873523
Epoch = 740, Average train loss:      0.00160345
Epoch = 740, Average test loss:      0.05281589
Epoch = 750, Average train loss:      0.00152964
Epoch = 750, Average test loss:      0.06416099
Epoch = 760, Average train loss:      0.00149199
Epoch = 760, Average test loss:      0.05293689
Epoch = 770, Average train loss:      0.00148724
Epoch = 770, Average test loss:      0.06044711
Epoch = 780, Average train loss:      0.00138933
Epoch = 780, Average test loss:      0.05718991
Epoch = 790, Average train loss:      0.00150107
Epoch = 790, Average test loss:      0.05095699
Epoch = 800, Average train loss:      0.00155602
Epoch = 800, Average test loss:      0.05575616
Epoch = 810, Average train loss:      0.00142471
Epoch = 810, Average test loss:      0.06865152
Epoch = 820, Average train loss:      0.00142007
Epoch = 820, Average test loss:      0.06773722
Epoch = 830, Average train loss:      0.00148804
Epoch = 830, Average test loss:      0.04899247
Epoch = 840, Average train loss:      0.00135583
Epoch = 840, Average test loss:      0.05187061
Epoch = 850, Average train loss:      0.00136426
Epoch = 850, Average test loss:      0.06333549
Epoch = 860, Average train loss:      0.00148778
Epoch = 860, Average test loss:      0.05882779
Epoch = 870, Average train loss:      0.00132779
Epoch = 870, Average test loss:      0.06103555
Epoch = 880, Average train loss:      0.00126652
Epoch = 880, Average test loss:      0.05463360
Epoch = 890, Average train loss:      0.00136587
Epoch = 890, Average test loss:      0.05366591
Epoch = 900, Average train loss:      0.00124092
Epoch = 900, Average test loss:      0.05729269
Epoch = 910, Average train loss:      0.00132344
Epoch = 910, Average test loss:      0.07161752
Epoch = 920, Average train loss:      0.00139791
Epoch = 920, Average test loss:      0.06740932
Epoch = 930, Average train loss:      0.00119372
Epoch = 930, Average test loss:      0.07300515
Epoch = 940, Average train loss:      0.00126429
Epoch = 940, Average test loss:      0.04908211
Epoch = 950, Average train loss:      0.00113051
Epoch = 950, Average test loss:      0.05980014
Epoch = 960, Average train loss:      0.00113635
Epoch = 960, Average test loss:      0.06752881
Epoch = 970, Average train loss:      0.00119734
Epoch = 970, Average test loss:      0.06170008
Epoch = 980, Average train loss:      0.00126654
Epoch = 980, Average test loss:      0.05222579
Epoch = 990, Average train loss:      0.00121291
Epoch = 990, Average test loss:      0.06218797
Epoch = 1000, Average train loss:      0.00121267
Epoch = 1000, Average test loss:      0.05872639
Final test: Average loss = 65.92435998525954
[[7.03632116e-01 1.40112966e-01 5.90398848e-01 5.11373170e-02]
 [8.37376356e-01 6.99431300e-01 5.79066753e-01 8.42525216e-04]
 [3.01257104e-01 9.71561968e-01 2.32472733e-01 7.82828871e-03]
 ...
 [7.61472046e-01 4.53901678e-01 9.61268842e-01 6.86416263e-03]
 [3.38590950e-01 1.51954487e-01 9.16326284e-01 1.83383841e-03]
 [5.53427637e-01 2.63359040e-01 2.02830415e-02 1.09836562e-02]]
(1000000, 4)
