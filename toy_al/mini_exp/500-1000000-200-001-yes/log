Start first sampling
sample_global_test has shape (200, 3)
val_global_test has shape (200, 4)
sample_train has shape (500, 3)
val_train has shape (500, 4)
sample_test has shape (1000000, 3)
val_test has shape (1000000, 4)
Start first training
X_train: torch.Size([500, 4]), y_train: torch.Size([500, 3]), X_test: torch.Size([1000000, 4]), y_test: torch.Size([1000000, 3]), X_global_test: torch.Size([200, 4]), y_global_test: torch.Size([200, 3])
Epoch = 10, Average train loss:      0.18032841
Epoch = 10, Average test loss:      0.17984447
Epoch = 20, Average train loss:      0.10592533
Epoch = 20, Average test loss:      0.10707767
Epoch = 30, Average train loss:      0.05532247
Epoch = 30, Average test loss:      0.05814260
Epoch = 40, Average train loss:      0.04040408
Epoch = 40, Average test loss:      0.04465437
Epoch = 50, Average train loss:      0.03502453
Epoch = 50, Average test loss:      0.03631824
Epoch = 60, Average train loss:      0.03322713
Epoch = 60, Average test loss:      0.03694233
Epoch = 70, Average train loss:      0.03193016
Epoch = 70, Average test loss:      0.03313560
Epoch = 80, Average train loss:      0.03049798
Epoch = 80, Average test loss:      0.03255034
Epoch = 90, Average train loss:      0.02887514
Epoch = 90, Average test loss:      0.03135528
Epoch = 100, Average train loss:      0.02791956
Epoch = 100, Average test loss:      0.03275981
Epoch = 110, Average train loss:      0.02672481
Epoch = 110, Average test loss:      0.03129672
Epoch = 120, Average train loss:      0.02634646
Epoch = 120, Average test loss:      0.02945570
Epoch = 130, Average train loss:      0.02584789
Epoch = 130, Average test loss:      0.02964317
Epoch = 140, Average train loss:      0.02431942
Epoch = 140, Average test loss:      0.02869277
Epoch = 150, Average train loss:      0.02296583
Epoch = 150, Average test loss:      0.02793106
Epoch = 160, Average train loss:      0.02187759
Epoch = 160, Average test loss:      0.02515879
Epoch = 170, Average train loss:      0.02094931
Epoch = 170, Average test loss:      0.02502885
Epoch = 180, Average train loss:      0.01994438
Epoch = 180, Average test loss:      0.02392323
Epoch = 190, Average train loss:      0.01909793
Epoch = 190, Average test loss:      0.02278937
Epoch = 200, Average train loss:      0.01808562
Epoch = 200, Average test loss:      0.02135098
Epoch = 210, Average train loss:      0.01746251
Epoch = 210, Average test loss:      0.02139130
Epoch = 220, Average train loss:      0.01672022
Epoch = 220, Average test loss:      0.02146525
Epoch = 230, Average train loss:      0.01751893
Epoch = 230, Average test loss:      0.02095379
Epoch = 240, Average train loss:      0.01606810
Epoch = 240, Average test loss:      0.01895020
Epoch = 250, Average train loss:      0.01546222
Epoch = 250, Average test loss:      0.02022387
Epoch = 260, Average train loss:      0.01506225
Epoch = 260, Average test loss:      0.01914977
Epoch = 270, Average train loss:      0.01419254
Epoch = 270, Average test loss:      0.01915731
Epoch = 280, Average train loss:      0.01358223
Epoch = 280, Average test loss:      0.01932834
Epoch = 290, Average train loss:      0.01318745
Epoch = 290, Average test loss:      0.01904312
Epoch = 300, Average train loss:      0.01306421
Epoch = 300, Average test loss:      0.01796017
Epoch = 310, Average train loss:      0.01290578
Epoch = 310, Average test loss:      0.01868169
Epoch = 320, Average train loss:      0.01424548
Epoch = 320, Average test loss:      0.01933340
Epoch = 330, Average train loss:      0.01165079
Epoch = 330, Average test loss:      0.01657435
Epoch = 340, Average train loss:      0.01114189
Epoch = 340, Average test loss:      0.01568437
Epoch = 350, Average train loss:      0.01094341
Epoch = 350, Average test loss:      0.01525790
Epoch = 360, Average train loss:      0.01039693
Epoch = 360, Average test loss:      0.01641978
Epoch = 370, Average train loss:      0.00968820
Epoch = 370, Average test loss:      0.01549025
Epoch = 380, Average train loss:      0.00970402
Epoch = 380, Average test loss:      0.01583913
Epoch = 390, Average train loss:      0.00921245
Epoch = 390, Average test loss:      0.01502651
Epoch = 400, Average train loss:      0.00899331
Epoch = 400, Average test loss:      0.01498786
Epoch = 410, Average train loss:      0.00840706
Epoch = 410, Average test loss:      0.01523686
Epoch = 420, Average train loss:      0.00802723
Epoch = 420, Average test loss:      0.01512228
Epoch = 430, Average train loss:      0.00819349
Epoch = 430, Average test loss:      0.01473557
Epoch = 440, Average train loss:      0.00787818
Epoch = 440, Average test loss:      0.01494246
Epoch = 450, Average train loss:      0.00749105
Epoch = 450, Average test loss:      0.01543821
Epoch = 460, Average train loss:      0.00820008
Epoch = 460, Average test loss:      0.01399581
Epoch = 470, Average train loss:      0.00779297
Epoch = 470, Average test loss:      0.01476184
Epoch = 480, Average train loss:      0.00751547
Epoch = 480, Average test loss:      0.01353380
Epoch = 490, Average train loss:      0.00739696
Epoch = 490, Average test loss:      0.01346856
Epoch = 500, Average train loss:      0.00717479
Epoch = 500, Average test loss:      0.01356898
Epoch = 510, Average train loss:      0.00673366
Epoch = 510, Average test loss:      0.01211187
Epoch = 520, Average train loss:      0.00635552
Epoch = 520, Average test loss:      0.01276992
Epoch = 530, Average train loss:      0.00681901
Epoch = 530, Average test loss:      0.01240420
Epoch = 540, Average train loss:      0.00658717
Epoch = 540, Average test loss:      0.01245760
Epoch = 550, Average train loss:      0.00606150
Epoch = 550, Average test loss:      0.01255605
Epoch = 560, Average train loss:      0.00624323
Epoch = 560, Average test loss:      0.01240815
Epoch = 570, Average train loss:      0.00588319
Epoch = 570, Average test loss:      0.01113108
Epoch = 580, Average train loss:      0.00640917
Epoch = 580, Average test loss:      0.01162181
Epoch = 590, Average train loss:      0.00610410
Epoch = 590, Average test loss:      0.01151096
Epoch = 600, Average train loss:      0.00686754
Epoch = 600, Average test loss:      0.01238149
Epoch = 610, Average train loss:      0.00628252
Epoch = 610, Average test loss:      0.01322360
Epoch = 620, Average train loss:      0.00589656
Epoch = 620, Average test loss:      0.01136912
Epoch = 630, Average train loss:      0.00585993
Epoch = 630, Average test loss:      0.01147132
Epoch = 640, Average train loss:      0.00561122
Epoch = 640, Average test loss:      0.01057699
Epoch = 650, Average train loss:      0.00559686
Epoch = 650, Average test loss:      0.01195212
Epoch = 660, Average train loss:      0.00526885
Epoch = 660, Average test loss:      0.01171291
Epoch = 670, Average train loss:      0.00522727
Epoch = 670, Average test loss:      0.01155435
Epoch = 680, Average train loss:      0.00504495
Epoch = 680, Average test loss:      0.01021599
Epoch = 690, Average train loss:      0.00560455
Epoch = 690, Average test loss:      0.01140436
Epoch = 700, Average train loss:      0.00530611
Epoch = 700, Average test loss:      0.01167927
Epoch = 710, Average train loss:      0.00671771
Epoch = 710, Average test loss:      0.01342968
Epoch = 720, Average train loss:      0.00627015
Epoch = 720, Average test loss:      0.01360718
Epoch = 730, Average train loss:      0.00581039
Epoch = 730, Average test loss:      0.01100812
Epoch = 740, Average train loss:      0.00547057
Epoch = 740, Average test loss:      0.01155678
Epoch = 750, Average train loss:      0.00508984
Epoch = 750, Average test loss:      0.01016946
Epoch = 760, Average train loss:      0.00491440
Epoch = 760, Average test loss:      0.01083372
Epoch = 770, Average train loss:      0.00482655
Epoch = 770, Average test loss:      0.00987682
Epoch = 780, Average train loss:      0.00480151
Epoch = 780, Average test loss:      0.00999621
Epoch = 790, Average train loss:      0.00494108
Epoch = 790, Average test loss:      0.00940186
Epoch = 800, Average train loss:      0.00450176
Epoch = 800, Average test loss:      0.01041667
Epoch = 810, Average train loss:      0.00833723
Epoch = 810, Average test loss:      0.01273896
Epoch = 820, Average train loss:      0.00579768
Epoch = 820, Average test loss:      0.00966343
Epoch = 830, Average train loss:      0.00527038
Epoch = 830, Average test loss:      0.01094257
Epoch = 840, Average train loss:      0.00487380
Epoch = 840, Average test loss:      0.00964728
Epoch = 850, Average train loss:      0.00478929
Epoch = 850, Average test loss:      0.01065521
Epoch = 860, Average train loss:      0.00465878
Epoch = 860, Average test loss:      0.01033818
Epoch = 870, Average train loss:      0.00478818
Epoch = 870, Average test loss:      0.01087988
Epoch = 880, Average train loss:      0.00482321
Epoch = 880, Average test loss:      0.01152488
Epoch = 890, Average train loss:      0.00464246
Epoch = 890, Average test loss:      0.00961751
Epoch = 900, Average train loss:      0.00439356
Epoch = 900, Average test loss:      0.00915440
Epoch = 910, Average train loss:      0.00434951
Epoch = 910, Average test loss:      0.00984502
Epoch = 920, Average train loss:      0.00497806
Epoch = 920, Average test loss:      0.00942050
Epoch = 930, Average train loss:      0.00423419
Epoch = 930, Average test loss:      0.00922146
Epoch = 940, Average train loss:      0.00427853
Epoch = 940, Average test loss:      0.00956253
Epoch = 950, Average train loss:      0.00401928
Epoch = 950, Average test loss:      0.00921875
Epoch = 960, Average train loss:      0.00412179
Epoch = 960, Average test loss:      0.00903512
Epoch = 970, Average train loss:      0.00425487
Epoch = 970, Average test loss:      0.00911580
Epoch = 980, Average train loss:      0.00432050
Epoch = 980, Average test loss:      0.00957193
Epoch = 990, Average train loss:      0.00405440
Epoch = 990, Average test loss:      0.00879676
Epoch = 1000, Average train loss:      0.00377055
Epoch = 1000, Average test loss:      0.00876868
Final test: Average loss = 0.06693628503608122
[[7.47110844e-01 1.30751818e-01 8.06944251e-01 4.45845304e-03]
 [9.36907291e-01 6.06532097e-01 7.10359216e-01 9.19725338e-04]
 [7.13586628e-01 9.92807984e-01 3.41538250e-01 2.77818367e-03]
 ...
 [6.33732259e-01 6.95592701e-01 5.05683482e-01 1.28744554e-03]
 [9.14083242e-01 6.12825334e-01 3.14909607e-01 8.42632799e-05]
 [6.23072386e-01 6.80434465e-01 8.23537290e-01 1.54023143e-02]]
(1000000, 4)
Start second sampling
test_output has shape (1000000, 4)
sample_train has shape (489, 3)
val_train has shape (489, 4)
sample_test has shape (1000000, 3)
val_test has shape (1000000, 4)
Start second trainig
X_train: torch.Size([489, 4]), y_train: torch.Size([489, 3]), X_test: torch.Size([1000000, 4]), y_test: torch.Size([1000000, 3]), X_global_test: torch.Size([200, 4]), y_global_test: torch.Size([200, 3])
Epoch = 10, Average train loss:      0.00271604
Epoch = 10, Average test loss:      0.01650089
Epoch = 20, Average train loss:      0.00198852
Epoch = 20, Average test loss:      0.01316994
Epoch = 30, Average train loss:      0.00181299
Epoch = 30, Average test loss:      0.01332005
Epoch = 40, Average train loss:      0.00174063
Epoch = 40, Average test loss:      0.01420780
Epoch = 50, Average train loss:      0.00153435
Epoch = 50, Average test loss:      0.01236751
Epoch = 60, Average train loss:      0.00154697
Epoch = 60, Average test loss:      0.01247799
Epoch = 70, Average train loss:      0.00159349
Epoch = 70, Average test loss:      0.01362107
Epoch = 80, Average train loss:      0.00141296
Epoch = 80, Average test loss:      0.01318424
Epoch = 90, Average train loss:      0.00141381
Epoch = 90, Average test loss:      0.01254549
Epoch = 100, Average train loss:      0.00127119
Epoch = 100, Average test loss:      0.01227862
Epoch = 110, Average train loss:      0.00131624
Epoch = 110, Average test loss:      0.01306644
Epoch = 120, Average train loss:      0.00138507
Epoch = 120, Average test loss:      0.01236702
Epoch = 130, Average train loss:      0.00121167
Epoch = 130, Average test loss:      0.01258585
Epoch = 140, Average train loss:      0.00118703
Epoch = 140, Average test loss:      0.01170810
Epoch = 150, Average train loss:      0.00113843
Epoch = 150, Average test loss:      0.01293877
Epoch = 160, Average train loss:      0.00107111
Epoch = 160, Average test loss:      0.01174847
Epoch = 170, Average train loss:      0.00104416
Epoch = 170, Average test loss:      0.01166333
Epoch = 180, Average train loss:      0.00106530
Epoch = 180, Average test loss:      0.01286381
Epoch = 190, Average train loss:      0.00100718
Epoch = 190, Average test loss:      0.01173673
Epoch = 200, Average train loss:      0.00097920
Epoch = 200, Average test loss:      0.01201488
Epoch = 210, Average train loss:      0.00099472
Epoch = 210, Average test loss:      0.01121626
Epoch = 220, Average train loss:      0.00089257
Epoch = 220, Average test loss:      0.01177718
Epoch = 230, Average train loss:      0.00085812
Epoch = 230, Average test loss:      0.01245698
Epoch = 240, Average train loss:      0.00096769
Epoch = 240, Average test loss:      0.01193907
Epoch = 250, Average train loss:      0.00104424
Epoch = 250, Average test loss:      0.01129133
Epoch = 260, Average train loss:      0.00091080
Epoch = 260, Average test loss:      0.01253443
Epoch = 270, Average train loss:      0.00090328
Epoch = 270, Average test loss:      0.01144360
Epoch = 280, Average train loss:      0.00084809
Epoch = 280, Average test loss:      0.01293978
Epoch = 290, Average train loss:      0.00091406
Epoch = 290, Average test loss:      0.01249848
Epoch = 300, Average train loss:      0.00081582
Epoch = 300, Average test loss:      0.01206863
Epoch = 310, Average train loss:      0.00093670
Epoch = 310, Average test loss:      0.01310030
Epoch = 320, Average train loss:      0.00088845
Epoch = 320, Average test loss:      0.01193929
Epoch = 330, Average train loss:      0.00076900
Epoch = 330, Average test loss:      0.01257558
Epoch = 340, Average train loss:      0.00082226
Epoch = 340, Average test loss:      0.01177749
Epoch = 350, Average train loss:      0.00079457
Epoch = 350, Average test loss:      0.01241134
Epoch = 360, Average train loss:      0.00087033
Epoch = 360, Average test loss:      0.01353150
Epoch = 370, Average train loss:      0.00080117
Epoch = 370, Average test loss:      0.01297365
Epoch = 380, Average train loss:      0.00084896
Epoch = 380, Average test loss:      0.01311812
Epoch = 390, Average train loss:      0.00083436
Epoch = 390, Average test loss:      0.01350421
Epoch = 400, Average train loss:      0.00079091
Epoch = 400, Average test loss:      0.01264000
Epoch = 410, Average train loss:      0.00086378
Epoch = 410, Average test loss:      0.01288257
Epoch = 420, Average train loss:      0.00071822
Epoch = 420, Average test loss:      0.01336262
Epoch = 430, Average train loss:      0.00073578
Epoch = 430, Average test loss:      0.01368318
Epoch = 440, Average train loss:      0.00087345
Epoch = 440, Average test loss:      0.01421563
Epoch = 450, Average train loss:      0.00075471
Epoch = 450, Average test loss:      0.01244194
Epoch = 460, Average train loss:      0.00075162
Epoch = 460, Average test loss:      0.01406631
Epoch = 470, Average train loss:      0.00069978
Epoch = 470, Average test loss:      0.01324249
Epoch = 480, Average train loss:      0.00081893
Epoch = 480, Average test loss:      0.01349676
Epoch = 490, Average train loss:      0.00065355
Epoch = 490, Average test loss:      0.01411557
Epoch = 500, Average train loss:      0.00058893
Epoch = 500, Average test loss:      0.01288011
Epoch = 510, Average train loss:      0.00062231
Epoch = 510, Average test loss:      0.01386879
Epoch = 520, Average train loss:      0.00084958
Epoch = 520, Average test loss:      0.01330881
Epoch = 530, Average train loss:      0.00063527
Epoch = 530, Average test loss:      0.01353916
Epoch = 540, Average train loss:      0.00076599
Epoch = 540, Average test loss:      0.01423978
Epoch = 550, Average train loss:      0.00067946
Epoch = 550, Average test loss:      0.01330533
Epoch = 560, Average train loss:      0.00064572
Epoch = 560, Average test loss:      0.01318515
Epoch = 570, Average train loss:      0.00061389
Epoch = 570, Average test loss:      0.01335452
Epoch = 580, Average train loss:      0.00062290
Epoch = 580, Average test loss:      0.01434170
Epoch = 590, Average train loss:      0.00053068
Epoch = 590, Average test loss:      0.01393039
Epoch = 600, Average train loss:      0.00065998
Epoch = 600, Average test loss:      0.01333342
Epoch = 610, Average train loss:      0.00083743
Epoch = 610, Average test loss:      0.01284243
Epoch = 620, Average train loss:      0.00055080
Epoch = 620, Average test loss:      0.01445857
Epoch = 630, Average train loss:      0.00059127
Epoch = 630, Average test loss:      0.01326932
Epoch = 640, Average train loss:      0.00058651
Epoch = 640, Average test loss:      0.01407507
Epoch = 650, Average train loss:      0.00054461
Epoch = 650, Average test loss:      0.01406503
Epoch = 660, Average train loss:      0.00088524
Epoch = 660, Average test loss:      0.01628627
Epoch = 670, Average train loss:      0.00075170
Epoch = 670, Average test loss:      0.01394762
Epoch = 680, Average train loss:      0.00066835
Epoch = 680, Average test loss:      0.01361327
Epoch = 690, Average train loss:      0.00054247
Epoch = 690, Average test loss:      0.01360646
Epoch = 700, Average train loss:      0.00056887
Epoch = 700, Average test loss:      0.01405189
Epoch = 710, Average train loss:      0.00052814
Epoch = 710, Average test loss:      0.01341777
Epoch = 720, Average train loss:      0.00046120
Epoch = 720, Average test loss:      0.01363367
Epoch = 730, Average train loss:      0.00055894
Epoch = 730, Average test loss:      0.01442976
Epoch = 740, Average train loss:      0.00045884
Epoch = 740, Average test loss:      0.01346350
Epoch = 750, Average train loss:      0.00042483
Epoch = 750, Average test loss:      0.01369219
Epoch = 760, Average train loss:      0.00050278
Epoch = 760, Average test loss:      0.01381405
Epoch = 770, Average train loss:      0.00045134
Epoch = 770, Average test loss:      0.01368152
Epoch = 780, Average train loss:      0.00047143
Epoch = 780, Average test loss:      0.01443547
Epoch = 790, Average train loss:      0.00060939
Epoch = 790, Average test loss:      0.01408945
Epoch = 800, Average train loss:      0.00040768
Epoch = 800, Average test loss:      0.01398241
Epoch = 810, Average train loss:      0.00076478
Epoch = 810, Average test loss:      0.01526839
Epoch = 820, Average train loss:      0.00082643
Epoch = 820, Average test loss:      0.01408312
Epoch = 830, Average train loss:      0.00059214
Epoch = 830, Average test loss:      0.01425724
Epoch = 840, Average train loss:      0.00053324
Epoch = 840, Average test loss:      0.01425145
Epoch = 850, Average train loss:      0.00045106
Epoch = 850, Average test loss:      0.01447136
Epoch = 860, Average train loss:      0.00048835
Epoch = 860, Average test loss:      0.01555486
Epoch = 870, Average train loss:      0.00035697
Epoch = 870, Average test loss:      0.01342555
Epoch = 880, Average train loss:      0.00046608
Epoch = 880, Average test loss:      0.01492165
Epoch = 890, Average train loss:      0.00033841
Epoch = 890, Average test loss:      0.01525803
Epoch = 900, Average train loss:      0.00036665
Epoch = 900, Average test loss:      0.01367980
Epoch = 910, Average train loss:      0.00042373
Epoch = 910, Average test loss:      0.01450983
Epoch = 920, Average train loss:      0.00060499
Epoch = 920, Average test loss:      0.01576784
Epoch = 930, Average train loss:      0.00040075
Epoch = 930, Average test loss:      0.01549088
Epoch = 940, Average train loss:      0.00041112
Epoch = 940, Average test loss:      0.01520876
Epoch = 950, Average train loss:      0.00049175
Epoch = 950, Average test loss:      0.01543261
Epoch = 960, Average train loss:      0.00037496
Epoch = 960, Average test loss:      0.01502498
Epoch = 970, Average train loss:      0.00051236
Epoch = 970, Average test loss:      0.01667813
Epoch = 980, Average train loss:      0.00037517
Epoch = 980, Average test loss:      0.01512381
Epoch = 990, Average train loss:      0.00075204
Epoch = 990, Average test loss:      0.01565456
Epoch = 1000, Average train loss:      0.00046747
Epoch = 1000, Average test loss:      0.01594801
Final test: Average loss = 0.8587742850003007
[[7.03632116e-01 1.40112966e-01 5.90398848e-01 8.06843964e-05]
 [8.37376356e-01 6.99431300e-01 5.79066753e-01 2.71607214e-03]
 [3.01257104e-01 9.71561968e-01 2.32472733e-01 4.34951484e-03]
 ...
 [7.61472046e-01 4.53901678e-01 9.61268842e-01 2.95710713e-02]
 [3.38590950e-01 1.51954487e-01 9.16326284e-01 8.05604970e-04]
 [5.53427637e-01 2.63359040e-01 2.02830415e-02 1.09136939e-01]]
(1000000, 4)
