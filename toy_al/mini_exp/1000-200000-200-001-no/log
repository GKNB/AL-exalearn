Start first sampling
sample_global_test has shape (200, 3)
val_global_test has shape (200, 4)
sample_train has shape (1000, 3)
val_train has shape (1000, 4)
sample_test has shape (200000, 3)
val_test has shape (200000, 4)
Start first training
X_train: torch.Size([1000, 4]), y_train: torch.Size([1000, 3]), X_test: torch.Size([200000, 4]), y_test: torch.Size([200000, 3]), X_global_test: torch.Size([200, 4]), y_global_test: torch.Size([200, 3])
Epoch = 10, Average train loss:      0.12107322
Epoch = 10, Average test loss:      0.12004872
Epoch = 20, Average train loss:      0.04616051
Epoch = 20, Average test loss:      0.04964238
Epoch = 30, Average train loss:      0.03523443
Epoch = 30, Average test loss:      0.03684879
Epoch = 40, Average train loss:      0.03236936
Epoch = 40, Average test loss:      0.03437179
Epoch = 50, Average train loss:      0.02908290
Epoch = 50, Average test loss:      0.02888238
Epoch = 60, Average train loss:      0.02676795
Epoch = 60, Average test loss:      0.02845807
Epoch = 70, Average train loss:      0.02530331
Epoch = 70, Average test loss:      0.02651124
Epoch = 80, Average train loss:      0.02371686
Epoch = 80, Average test loss:      0.02532880
Epoch = 90, Average train loss:      0.02235946
Epoch = 90, Average test loss:      0.02457988
Epoch = 100, Average train loss:      0.02109520
Epoch = 100, Average test loss:      0.02480843
Epoch = 110, Average train loss:      0.01687022
Epoch = 110, Average test loss:      0.01999431
Epoch = 120, Average train loss:      0.01440161
Epoch = 120, Average test loss:      0.01831007
Epoch = 130, Average train loss:      0.01381543
Epoch = 130, Average test loss:      0.01837608
Epoch = 140, Average train loss:      0.01207060
Epoch = 140, Average test loss:      0.01530863
Epoch = 150, Average train loss:      0.01133132
Epoch = 150, Average test loss:      0.01488653
Epoch = 160, Average train loss:      0.01026080
Epoch = 160, Average test loss:      0.01347056
Epoch = 170, Average train loss:      0.01021691
Epoch = 170, Average test loss:      0.01275382
Epoch = 180, Average train loss:      0.00936209
Epoch = 180, Average test loss:      0.01208577
Epoch = 190, Average train loss:      0.01014490
Epoch = 190, Average test loss:      0.01295177
Epoch = 200, Average train loss:      0.00842134
Epoch = 200, Average test loss:      0.01046180
Epoch = 210, Average train loss:      0.01129399
Epoch = 210, Average test loss:      0.01251060
Epoch = 220, Average train loss:      0.00820317
Epoch = 220, Average test loss:      0.00995655
Epoch = 230, Average train loss:      0.00790716
Epoch = 230, Average test loss:      0.00975134
Epoch = 240, Average train loss:      0.00719981
Epoch = 240, Average test loss:      0.00836766
Epoch = 250, Average train loss:      0.00712033
Epoch = 250, Average test loss:      0.00898365
Epoch = 260, Average train loss:      0.00698790
Epoch = 260, Average test loss:      0.00851373
Epoch = 270, Average train loss:      0.00699580
Epoch = 270, Average test loss:      0.00930481
Epoch = 280, Average train loss:      0.00757917
Epoch = 280, Average test loss:      0.01131798
Epoch = 290, Average train loss:      0.00711570
Epoch = 290, Average test loss:      0.01032118
Epoch = 300, Average train loss:      0.00630707
Epoch = 300, Average test loss:      0.00731101
Epoch = 310, Average train loss:      0.00628677
Epoch = 310, Average test loss:      0.01014042
Epoch = 320, Average train loss:      0.00608125
Epoch = 320, Average test loss:      0.00790921
Epoch = 330, Average train loss:      0.00617656
Epoch = 330, Average test loss:      0.00813129
Epoch = 340, Average train loss:      0.00611807
Epoch = 340, Average test loss:      0.00884729
Epoch = 350, Average train loss:      0.00600237
Epoch = 350, Average test loss:      0.00799899
Epoch = 360, Average train loss:      0.00583148
Epoch = 360, Average test loss:      0.00835450
Epoch = 370, Average train loss:      0.00591778
Epoch = 370, Average test loss:      0.00835001
Epoch = 380, Average train loss:      0.00602275
Epoch = 380, Average test loss:      0.00865989
Epoch = 390, Average train loss:      0.00590051
Epoch = 390, Average test loss:      0.00834773
Epoch = 400, Average train loss:      0.00538297
Epoch = 400, Average test loss:      0.00767541
Epoch = 410, Average train loss:      0.00560969
Epoch = 410, Average test loss:      0.00772408
Epoch = 420, Average train loss:      0.00572234
Epoch = 420, Average test loss:      0.00787418
Epoch = 430, Average train loss:      0.00602157
Epoch = 430, Average test loss:      0.00783806
Epoch = 440, Average train loss:      0.00576422
Epoch = 440, Average test loss:      0.00764243
Epoch = 450, Average train loss:      0.00555482
Epoch = 450, Average test loss:      0.00802776
Epoch = 460, Average train loss:      0.00519411
Epoch = 460, Average test loss:      0.00643463
Epoch = 470, Average train loss:      0.00607102
Epoch = 470, Average test loss:      0.00755107
Epoch = 480, Average train loss:      0.00568403
Epoch = 480, Average test loss:      0.00733478
Epoch = 490, Average train loss:      0.00549268
Epoch = 490, Average test loss:      0.00829544
Epoch = 500, Average train loss:      0.00490724
Epoch = 500, Average test loss:      0.00680276
Epoch = 510, Average train loss:      0.00509385
Epoch = 510, Average test loss:      0.00627490
Epoch = 520, Average train loss:      0.00467440
Epoch = 520, Average test loss:      0.00583469
Epoch = 530, Average train loss:      0.00568966
Epoch = 530, Average test loss:      0.00668664
Epoch = 540, Average train loss:      0.00477264
Epoch = 540, Average test loss:      0.00709241
Epoch = 550, Average train loss:      0.00463434
Epoch = 550, Average test loss:      0.00622192
Epoch = 560, Average train loss:      0.00634986
Epoch = 560, Average test loss:      0.00894354
Epoch = 570, Average train loss:      0.00470685
Epoch = 570, Average test loss:      0.00721211
Epoch = 580, Average train loss:      0.00505848
Epoch = 580, Average test loss:      0.00777386
Epoch = 590, Average train loss:      0.00449586
Epoch = 590, Average test loss:      0.00561138
Epoch = 600, Average train loss:      0.00464389
Epoch = 600, Average test loss:      0.00708356
Epoch = 610, Average train loss:      0.00439114
Epoch = 610, Average test loss:      0.00607840
Epoch = 620, Average train loss:      0.00447011
Epoch = 620, Average test loss:      0.00819851
Epoch = 630, Average train loss:      0.00435440
Epoch = 630, Average test loss:      0.00609761
Epoch = 640, Average train loss:      0.00422074
Epoch = 640, Average test loss:      0.00648660
Epoch = 650, Average train loss:      0.00487135
Epoch = 650, Average test loss:      0.00726407
Epoch = 660, Average train loss:      0.00434926
Epoch = 660, Average test loss:      0.00688827
Epoch = 670, Average train loss:      0.00438918
Epoch = 670, Average test loss:      0.00688258
Epoch = 680, Average train loss:      0.00432161
Epoch = 680, Average test loss:      0.00627769
Epoch = 690, Average train loss:      0.00406203
Epoch = 690, Average test loss:      0.00647575
Epoch = 700, Average train loss:      0.00445653
Epoch = 700, Average test loss:      0.00681871
Epoch = 710, Average train loss:      0.00410570
Epoch = 710, Average test loss:      0.00585437
Epoch = 720, Average train loss:      0.00434365
Epoch = 720, Average test loss:      0.00614628
Epoch = 730, Average train loss:      0.00459940
Epoch = 730, Average test loss:      0.00505119
Epoch = 740, Average train loss:      0.00404661
Epoch = 740, Average test loss:      0.00535831
Epoch = 750, Average train loss:      0.00451582
Epoch = 750, Average test loss:      0.00600696
Epoch = 760, Average train loss:      0.00404172
Epoch = 760, Average test loss:      0.00588633
Epoch = 770, Average train loss:      0.00425354
Epoch = 770, Average test loss:      0.00594837
Epoch = 780, Average train loss:      0.00400665
Epoch = 780, Average test loss:      0.00686046
Epoch = 790, Average train loss:      0.00394671
Epoch = 790, Average test loss:      0.00566440
Epoch = 800, Average train loss:      0.00441714
Epoch = 800, Average test loss:      0.00655559
Epoch = 810, Average train loss:      0.01204708
Epoch = 810, Average test loss:      0.01499238
Epoch = 820, Average train loss:      0.00497239
Epoch = 820, Average test loss:      0.00775415
Epoch = 830, Average train loss:      0.00462186
Epoch = 830, Average test loss:      0.00675409
Epoch = 840, Average train loss:      0.01108462
Epoch = 840, Average test loss:      0.01039394
Epoch = 850, Average train loss:      0.00725765
Epoch = 850, Average test loss:      0.00935961
Epoch = 860, Average train loss:      0.00579985
Epoch = 860, Average test loss:      0.00749836
Epoch = 870, Average train loss:      0.00526783
Epoch = 870, Average test loss:      0.00740967
Epoch = 880, Average train loss:      0.00490845
Epoch = 880, Average test loss:      0.00776251
Epoch = 890, Average train loss:      0.00450138
Epoch = 890, Average test loss:      0.00704989
Epoch = 900, Average train loss:      0.00500253
Epoch = 900, Average test loss:      0.00717534
Epoch = 910, Average train loss:      0.00488729
Epoch = 910, Average test loss:      0.00820912
Epoch = 920, Average train loss:      0.00454074
Epoch = 920, Average test loss:      0.00711619
Epoch = 930, Average train loss:      0.00435877
Epoch = 930, Average test loss:      0.00580743
Epoch = 940, Average train loss:      0.00456199
Epoch = 940, Average test loss:      0.00731309
Epoch = 950, Average train loss:      0.00412632
Epoch = 950, Average test loss:      0.00684368
Epoch = 960, Average train loss:      0.00427768
Epoch = 960, Average test loss:      0.00582775
Epoch = 970, Average train loss:      0.00465607
Epoch = 970, Average test loss:      0.00638659
Epoch = 980, Average train loss:      0.00455874
Epoch = 980, Average test loss:      0.00619271
Epoch = 990, Average train loss:      0.00422679
Epoch = 990, Average test loss:      0.00752369
Epoch = 1000, Average train loss:      0.00438492
Epoch = 1000, Average test loss:      0.00573081
Final test: Average loss = 0.006093858310972348
[[2.86835551e-01 1.30024999e-01 5.01209140e-01 1.74340804e-03]
 [2.20048323e-01 9.35550869e-01 4.00316250e-03 2.30286960e-02]
 [1.43196732e-01 2.46475860e-01 1.98956713e-01 1.47759449e-03]
 ...
 [9.72739220e-01 5.58818579e-01 8.18320215e-01 4.14864114e-03]
 [6.35139585e-01 5.69691658e-01 2.44872048e-02 3.67125496e-04]
 [3.01971942e-01 2.20106632e-01 3.00636496e-02 5.94612386e-04]]
(200000, 4)
Start second sampling
test_output has shape (200000, 4)
sample_train has shape (978, 3)
val_train has shape (978, 4)
sample_test has shape (200000, 3)
val_test has shape (200000, 4)
Start second trainig
X_train: torch.Size([978, 4]), y_train: torch.Size([978, 3]), X_test: torch.Size([200000, 4]), y_test: torch.Size([200000, 3]), X_global_test: torch.Size([200, 4]), y_global_test: torch.Size([200, 3])
Epoch = 10, Average train loss:      0.20456435
Epoch = 10, Average test loss:      0.19234715
Epoch = 20, Average train loss:      0.05179905
Epoch = 20, Average test loss:      0.04964460
Epoch = 30, Average train loss:      0.03675056
Epoch = 30, Average test loss:      0.03850380
Epoch = 40, Average train loss:      0.03351577
Epoch = 40, Average test loss:      0.03394555
Epoch = 50, Average train loss:      0.03269486
Epoch = 50, Average test loss:      0.03367832
Epoch = 60, Average train loss:      0.03023492
Epoch = 60, Average test loss:      0.02974728
Epoch = 70, Average train loss:      0.03006504
Epoch = 70, Average test loss:      0.03141954
Epoch = 80, Average train loss:      0.02818843
Epoch = 80, Average test loss:      0.02846698
Epoch = 90, Average train loss:      0.02722840
Epoch = 90, Average test loss:      0.02729041
Epoch = 100, Average train loss:      0.02721187
Epoch = 100, Average test loss:      0.02895351
Epoch = 110, Average train loss:      0.02598413
Epoch = 110, Average test loss:      0.02796516
Epoch = 120, Average train loss:      0.02475506
Epoch = 120, Average test loss:      0.02457210
Epoch = 130, Average train loss:      0.02424920
Epoch = 130, Average test loss:      0.02543113
Epoch = 140, Average train loss:      0.02340906
Epoch = 140, Average test loss:      0.02353204
Epoch = 150, Average train loss:      0.02282043
Epoch = 150, Average test loss:      0.02307488
Epoch = 160, Average train loss:      0.02194161
Epoch = 160, Average test loss:      0.02244816
Epoch = 170, Average train loss:      0.02112407
Epoch = 170, Average test loss:      0.02285818
Epoch = 180, Average train loss:      0.01990698
Epoch = 180, Average test loss:      0.02049267
Epoch = 190, Average train loss:      0.01895872
Epoch = 190, Average test loss:      0.01907842
Epoch = 200, Average train loss:      0.01760835
Epoch = 200, Average test loss:      0.01827611
Epoch = 210, Average train loss:      0.01628491
Epoch = 210, Average test loss:      0.01674609
Epoch = 220, Average train loss:      0.01395915
Epoch = 220, Average test loss:      0.01537261
Epoch = 230, Average train loss:      0.01254776
Epoch = 230, Average test loss:      0.01546748
Epoch = 240, Average train loss:      0.01146139
Epoch = 240, Average test loss:      0.01416590
Epoch = 250, Average train loss:      0.01220168
Epoch = 250, Average test loss:      0.01593926
Epoch = 260, Average train loss:      0.00990206
Epoch = 260, Average test loss:      0.01380464
Epoch = 270, Average train loss:      0.01009770
Epoch = 270, Average test loss:      0.01268596
Epoch = 280, Average train loss:      0.00919165
Epoch = 280, Average test loss:      0.01094778
Epoch = 290, Average train loss:      0.00828902
Epoch = 290, Average test loss:      0.01038143
Epoch = 300, Average train loss:      0.05516990
Epoch = 300, Average test loss:      0.01728204
Epoch = 310, Average train loss:      0.00896242
Epoch = 310, Average test loss:      0.01186208
Epoch = 320, Average train loss:      0.00874310
Epoch = 320, Average test loss:      0.01087563
Epoch = 330, Average train loss:      0.00835202
Epoch = 330, Average test loss:      0.01196185
Epoch = 340, Average train loss:      0.00794779
Epoch = 340, Average test loss:      0.01038217
Epoch = 350, Average train loss:      0.00748546
Epoch = 350, Average test loss:      0.01111587
Epoch = 360, Average train loss:      0.00739177
Epoch = 360, Average test loss:      0.01027838
Epoch = 370, Average train loss:      0.00694094
Epoch = 370, Average test loss:      0.00961466
Epoch = 380, Average train loss:      0.00750460
Epoch = 380, Average test loss:      0.00974361
Epoch = 390, Average train loss:      0.00718006
Epoch = 390, Average test loss:      0.00888284
Epoch = 400, Average train loss:      0.00691956
Epoch = 400, Average test loss:      0.00963997
Epoch = 410, Average train loss:      0.00691050
Epoch = 410, Average test loss:      0.00995265
Epoch = 420, Average train loss:      0.00664281
Epoch = 420, Average test loss:      0.01015816
Epoch = 430, Average train loss:      0.00696806
Epoch = 430, Average test loss:      0.01033527
Epoch = 440, Average train loss:      0.00647215
Epoch = 440, Average test loss:      0.00882334
Epoch = 450, Average train loss:      0.00688043
Epoch = 450, Average test loss:      0.00985599
Epoch = 460, Average train loss:      0.00608155
Epoch = 460, Average test loss:      0.00833594
Epoch = 470, Average train loss:      0.00696161
Epoch = 470, Average test loss:      0.01107723
Epoch = 480, Average train loss:      0.00580163
Epoch = 480, Average test loss:      0.00849438
Epoch = 490, Average train loss:      0.00635453
Epoch = 490, Average test loss:      0.00929043
Epoch = 500, Average train loss:      0.00669419
Epoch = 500, Average test loss:      0.00863461
Epoch = 510, Average train loss:      0.00576894
Epoch = 510, Average test loss:      0.00819180
Epoch = 520, Average train loss:      0.00580268
Epoch = 520, Average test loss:      0.00979314
Epoch = 530, Average train loss:      0.00613314
Epoch = 530, Average test loss:      0.00912683
Epoch = 540, Average train loss:      0.00638654
Epoch = 540, Average test loss:      0.00896838
Epoch = 550, Average train loss:      0.00556525
Epoch = 550, Average test loss:      0.00885524
Epoch = 560, Average train loss:      0.00583991
Epoch = 560, Average test loss:      0.00876635
Epoch = 570, Average train loss:      0.00651143
Epoch = 570, Average test loss:      0.00978219
Epoch = 580, Average train loss:      0.00544057
Epoch = 580, Average test loss:      0.00934953
Epoch = 590, Average train loss:      0.00572259
Epoch = 590, Average test loss:      0.00796761
Epoch = 600, Average train loss:      0.00535407
Epoch = 600, Average test loss:      0.00901454
Epoch = 610, Average train loss:      0.00566555
Epoch = 610, Average test loss:      0.00836299
Epoch = 620, Average train loss:      0.00527595
Epoch = 620, Average test loss:      0.00812383
Epoch = 630, Average train loss:      0.00563841
Epoch = 630, Average test loss:      0.00949757
Epoch = 640, Average train loss:      0.00578890
Epoch = 640, Average test loss:      0.00868561
Epoch = 650, Average train loss:      0.00543821
Epoch = 650, Average test loss:      0.00748362
Epoch = 660, Average train loss:      0.00600047
Epoch = 660, Average test loss:      0.00834240
Epoch = 670, Average train loss:      0.00523767
Epoch = 670, Average test loss:      0.00851137
Epoch = 680, Average train loss:      0.00533385
Epoch = 680, Average test loss:      0.00808728
Epoch = 690, Average train loss:      0.00494536
Epoch = 690, Average test loss:      0.00778914
Epoch = 700, Average train loss:      0.00512639
Epoch = 700, Average test loss:      0.00760704
Epoch = 710, Average train loss:      0.00556957
Epoch = 710, Average test loss:      0.00767037
Epoch = 720, Average train loss:      0.00630863
Epoch = 720, Average test loss:      0.00931179
Epoch = 730, Average train loss:      0.00618068
Epoch = 730, Average test loss:      0.00800856
Epoch = 740, Average train loss:      0.00639580
Epoch = 740, Average test loss:      0.00908044
Epoch = 750, Average train loss:      0.00830768
Epoch = 750, Average test loss:      0.01103023
Epoch = 760, Average train loss:      0.00645348
Epoch = 760, Average test loss:      0.00948126
Epoch = 770, Average train loss:      0.00546578
Epoch = 770, Average test loss:      0.00817084
Epoch = 780, Average train loss:      0.00542152
Epoch = 780, Average test loss:      0.00854836
Epoch = 790, Average train loss:      0.00536265
Epoch = 790, Average test loss:      0.00841459
Epoch = 800, Average train loss:      0.00525838
Epoch = 800, Average test loss:      0.00803291
Epoch = 810, Average train loss:      0.00514578
Epoch = 810, Average test loss:      0.00896585
Epoch = 820, Average train loss:      0.00513310
Epoch = 820, Average test loss:      0.00884695
Epoch = 830, Average train loss:      0.00526883
Epoch = 830, Average test loss:      0.00764969
Epoch = 840, Average train loss:      0.00523789
Epoch = 840, Average test loss:      0.00880218
Epoch = 850, Average train loss:      0.00470963
Epoch = 850, Average test loss:      0.00844376
Epoch = 860, Average train loss:      0.00514535
Epoch = 860, Average test loss:      0.00776166
Epoch = 870, Average train loss:      0.00462826
Epoch = 870, Average test loss:      0.00737483
Epoch = 880, Average train loss:      0.00445145
Epoch = 880, Average test loss:      0.00824934
Epoch = 890, Average train loss:      0.00524136
Epoch = 890, Average test loss:      0.00868529
Epoch = 900, Average train loss:      0.00480089
Epoch = 900, Average test loss:      0.00820424
Epoch = 910, Average train loss:      0.00454460
Epoch = 910, Average test loss:      0.00784052
Epoch = 920, Average train loss:      0.00496843
Epoch = 920, Average test loss:      0.00867561
Epoch = 930, Average train loss:      0.00443602
Epoch = 930, Average test loss:      0.00818739
Epoch = 940, Average train loss:      0.00475491
Epoch = 940, Average test loss:      0.00905555
Epoch = 950, Average train loss:      0.00424943
Epoch = 950, Average test loss:      0.00715739
Epoch = 960, Average train loss:      0.00505250
Epoch = 960, Average test loss:      0.00822813
Epoch = 970, Average train loss:      0.00444094
Epoch = 970, Average test loss:      0.00836109
Epoch = 980, Average train loss:      0.00416974
Epoch = 980, Average test loss:      0.00769238
Epoch = 990, Average train loss:      0.00451588
Epoch = 990, Average test loss:      0.00749623
Epoch = 1000, Average train loss:      0.00453962
Epoch = 1000, Average test loss:      0.00824863
Final test: Average loss = 0.006459089625606748
[[8.14470232e-01 2.92970631e-02 2.42925689e-01 1.31984428e-02]
 [4.33142275e-01 9.71647739e-01 6.23534666e-03 2.46911572e-04]
 [5.33779431e-03 9.74238887e-02 4.69152212e-01 2.16694293e-03]
 ...
 [9.49834406e-01 8.63009214e-01 4.79160696e-01 2.30309018e-03]
 [7.18934119e-01 1.81998461e-02 5.18547952e-01 1.88464226e-04]
 [4.38004494e-01 7.61505544e-01 4.17593271e-01 7.71935610e-03]]
(200000, 4)
