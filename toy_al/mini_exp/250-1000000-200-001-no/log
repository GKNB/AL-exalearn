Start first sampling
sample_global_test has shape (200, 3)
val_global_test has shape (200, 4)
sample_train has shape (250, 3)
val_train has shape (250, 4)
sample_test has shape (1000000, 3)
val_test has shape (1000000, 4)
Start first training
X_train: torch.Size([250, 4]), y_train: torch.Size([250, 3]), X_test: torch.Size([1000000, 4]), y_test: torch.Size([1000000, 3]), X_global_test: torch.Size([200, 4]), y_global_test: torch.Size([200, 3])
Epoch = 10, Average train loss:      0.22373924
Epoch = 10, Average test loss:      0.22572988
Epoch = 20, Average train loss:      0.17388874
Epoch = 20, Average test loss:      0.17517473
Epoch = 30, Average train loss:      0.13286351
Epoch = 30, Average test loss:      0.13546307
Epoch = 40, Average train loss:      0.09625293
Epoch = 40, Average test loss:      0.09954922
Epoch = 50, Average train loss:      0.06661759
Epoch = 50, Average test loss:      0.06805044
Epoch = 60, Average train loss:      0.04862013
Epoch = 60, Average test loss:      0.05206772
Epoch = 70, Average train loss:      0.04007061
Epoch = 70, Average test loss:      0.04207207
Epoch = 80, Average train loss:      0.03597743
Epoch = 80, Average test loss:      0.03985804
Epoch = 90, Average train loss:      0.03337484
Epoch = 90, Average test loss:      0.03588987
Epoch = 100, Average train loss:      0.03221803
Epoch = 100, Average test loss:      0.03655832
Epoch = 110, Average train loss:      0.03096834
Epoch = 110, Average test loss:      0.03609926
Epoch = 120, Average train loss:      0.03495378
Epoch = 120, Average test loss:      0.03304471
Epoch = 130, Average train loss:      0.03263108
Epoch = 130, Average test loss:      0.03727777
Epoch = 140, Average train loss:      0.02915023
Epoch = 140, Average test loss:      0.03538908
Epoch = 150, Average train loss:      0.02822387
Epoch = 150, Average test loss:      0.03369952
Epoch = 160, Average train loss:      0.02776195
Epoch = 160, Average test loss:      0.03233909
Epoch = 170, Average train loss:      0.02724525
Epoch = 170, Average test loss:      0.03273092
Epoch = 180, Average train loss:      0.02670553
Epoch = 180, Average test loss:      0.03167441
Epoch = 190, Average train loss:      0.02626952
Epoch = 190, Average test loss:      0.03147043
Epoch = 200, Average train loss:      0.02581644
Epoch = 200, Average test loss:      0.02948605
Epoch = 210, Average train loss:      0.02561733
Epoch = 210, Average test loss:      0.03004896
Epoch = 220, Average train loss:      0.02579450
Epoch = 220, Average test loss:      0.02999833
Epoch = 230, Average train loss:      0.02510598
Epoch = 230, Average test loss:      0.02918919
Epoch = 240, Average train loss:      0.02464763
Epoch = 240, Average test loss:      0.02812595
Epoch = 250, Average train loss:      0.02407621
Epoch = 250, Average test loss:      0.03007903
Epoch = 260, Average train loss:      0.02361732
Epoch = 260, Average test loss:      0.02782895
Epoch = 270, Average train loss:      0.02307108
Epoch = 270, Average test loss:      0.02824444
Epoch = 280, Average train loss:      0.02258644
Epoch = 280, Average test loss:      0.02873636
Epoch = 290, Average train loss:      0.02184933
Epoch = 290, Average test loss:      0.02800452
Epoch = 300, Average train loss:      0.02106413
Epoch = 300, Average test loss:      0.02652081
Epoch = 310, Average train loss:      0.02027735
Epoch = 310, Average test loss:      0.02801282
Epoch = 320, Average train loss:      0.01946364
Epoch = 320, Average test loss:      0.02400376
Epoch = 330, Average train loss:      0.01862552
Epoch = 330, Average test loss:      0.02375070
Epoch = 340, Average train loss:      0.01776304
Epoch = 340, Average test loss:      0.02245647
Epoch = 350, Average train loss:      0.01701867
Epoch = 350, Average test loss:      0.02146388
Epoch = 360, Average train loss:      0.01613859
Epoch = 360, Average test loss:      0.02215273
Epoch = 370, Average train loss:      0.01570565
Epoch = 370, Average test loss:      0.02037017
Epoch = 380, Average train loss:      0.01511874
Epoch = 380, Average test loss:      0.02080244
Epoch = 390, Average train loss:      0.01515175
Epoch = 390, Average test loss:      0.02030034
Epoch = 400, Average train loss:      0.01416431
Epoch = 400, Average test loss:      0.01954350
Epoch = 410, Average train loss:      0.01348672
Epoch = 410, Average test loss:      0.01952624
Epoch = 420, Average train loss:      0.01318379
Epoch = 420, Average test loss:      0.01958831
Epoch = 430, Average train loss:      0.01335644
Epoch = 430, Average test loss:      0.02012046
Epoch = 440, Average train loss:      0.01250052
Epoch = 440, Average test loss:      0.02018347
Epoch = 450, Average train loss:      0.01160529
Epoch = 450, Average test loss:      0.01966144
Epoch = 460, Average train loss:      0.01109376
Epoch = 460, Average test loss:      0.01908274
Epoch = 470, Average train loss:      0.01054632
Epoch = 470, Average test loss:      0.01739033
Epoch = 480, Average train loss:      0.01001965
Epoch = 480, Average test loss:      0.01753736
Epoch = 490, Average train loss:      0.00950376
Epoch = 490, Average test loss:      0.01646955
Epoch = 500, Average train loss:      0.00908532
Epoch = 500, Average test loss:      0.01689521
Epoch = 510, Average train loss:      0.00898322
Epoch = 510, Average test loss:      0.01574979
Epoch = 520, Average train loss:      0.00858458
Epoch = 520, Average test loss:      0.01630265
Epoch = 530, Average train loss:      0.00851811
Epoch = 530, Average test loss:      0.01701955
Epoch = 540, Average train loss:      0.00836855
Epoch = 540, Average test loss:      0.01591463
Epoch = 550, Average train loss:      0.00779908
Epoch = 550, Average test loss:      0.01623496
Epoch = 560, Average train loss:      0.00747165
Epoch = 560, Average test loss:      0.01449698
Epoch = 570, Average train loss:      0.00719903
Epoch = 570, Average test loss:      0.01418034
Epoch = 580, Average train loss:      0.00704346
Epoch = 580, Average test loss:      0.01497556
Epoch = 590, Average train loss:      0.00704993
Epoch = 590, Average test loss:      0.01542319
Epoch = 600, Average train loss:      0.00666877
Epoch = 600, Average test loss:      0.01562170
Epoch = 610, Average train loss:      0.00661882
Epoch = 610, Average test loss:      0.01506704
Epoch = 620, Average train loss:      0.00664293
Epoch = 620, Average test loss:      0.01439785
Epoch = 630, Average train loss:      0.00633599
Epoch = 630, Average test loss:      0.01432016
Epoch = 640, Average train loss:      0.00619561
Epoch = 640, Average test loss:      0.01318168
Epoch = 650, Average train loss:      0.00608533
Epoch = 650, Average test loss:      0.01443120
Epoch = 660, Average train loss:      0.00592596
Epoch = 660, Average test loss:      0.01453779
Epoch = 670, Average train loss:      0.00599545
Epoch = 670, Average test loss:      0.01384913
Epoch = 680, Average train loss:      0.00577325
Epoch = 680, Average test loss:      0.01314635
Epoch = 690, Average train loss:      0.00565335
Epoch = 690, Average test loss:      0.01324149
Epoch = 700, Average train loss:      0.00551142
Epoch = 700, Average test loss:      0.01478213
Epoch = 710, Average train loss:      0.00550542
Epoch = 710, Average test loss:      0.01368291
Epoch = 720, Average train loss:      0.00548985
Epoch = 720, Average test loss:      0.01381281
Epoch = 730, Average train loss:      0.00533250
Epoch = 730, Average test loss:      0.01188086
Epoch = 740, Average train loss:      0.00529636
Epoch = 740, Average test loss:      0.01328106
Epoch = 750, Average train loss:      0.00522348
Epoch = 750, Average test loss:      0.01257070
Epoch = 760, Average train loss:      0.00509026
Epoch = 760, Average test loss:      0.01310478
Epoch = 770, Average train loss:      0.00513041
Epoch = 770, Average test loss:      0.01344134
Epoch = 780, Average train loss:      0.00500679
Epoch = 780, Average test loss:      0.01307545
Epoch = 790, Average train loss:      0.00495427
Epoch = 790, Average test loss:      0.01234480
Epoch = 800, Average train loss:      0.00501503
Epoch = 800, Average test loss:      0.01327563
Epoch = 810, Average train loss:      0.00488145
Epoch = 810, Average test loss:      0.01374800
Epoch = 820, Average train loss:      0.00490343
Epoch = 820, Average test loss:      0.01253963
Epoch = 830, Average train loss:      0.00468028
Epoch = 830, Average test loss:      0.01345211
Epoch = 840, Average train loss:      0.00471118
Epoch = 840, Average test loss:      0.01216685
Epoch = 850, Average train loss:      0.00469972
Epoch = 850, Average test loss:      0.01343535
Epoch = 860, Average train loss:      0.00458089
Epoch = 860, Average test loss:      0.01287161
Epoch = 870, Average train loss:      0.00451785
Epoch = 870, Average test loss:      0.01312951
Epoch = 880, Average train loss:      0.00452715
Epoch = 880, Average test loss:      0.01315102
Epoch = 890, Average train loss:      0.00440230
Epoch = 890, Average test loss:      0.01258995
Epoch = 900, Average train loss:      0.00445960
Epoch = 900, Average test loss:      0.01352969
Epoch = 910, Average train loss:      0.00446387
Epoch = 910, Average test loss:      0.01307952
Epoch = 920, Average train loss:      0.00455951
Epoch = 920, Average test loss:      0.01308954
Epoch = 930, Average train loss:      0.00438251
Epoch = 930, Average test loss:      0.01283530
Epoch = 940, Average train loss:      0.00440633
Epoch = 940, Average test loss:      0.01284703
Epoch = 950, Average train loss:      0.00427572
Epoch = 950, Average test loss:      0.01337401
Epoch = 960, Average train loss:      0.00419767
Epoch = 960, Average test loss:      0.01273804
Epoch = 970, Average train loss:      0.00421446
Epoch = 970, Average test loss:      0.01327698
Epoch = 980, Average train loss:      0.00424157
Epoch = 980, Average test loss:      0.01261330
Epoch = 990, Average train loss:      0.00420138
Epoch = 990, Average test loss:      0.01331212
Epoch = 1000, Average train loss:      0.00409248
Epoch = 1000, Average test loss:      0.01228922
Final test: Average loss = 0.10406905813288356
[[0.79475057 0.83771688 0.28439713 0.03892228]
 [0.30379662 0.87433428 0.02397036 0.01105085]
 [0.52045745 0.46367571 0.69012678 0.00105556]
 ...
 [0.91614288 0.91591096 0.08190512 0.10752048]
 [0.02361029 0.35861748 0.93099266 0.01217057]
 [0.58251595 0.97350639 0.56217974 0.00468117]]
(1000000, 4)
Start second sampling
test_output has shape (1000000, 4)
sample_train has shape (248, 3)
val_train has shape (248, 4)
sample_test has shape (1000000, 3)
val_test has shape (1000000, 4)
Start second trainig
X_train: torch.Size([248, 4]), y_train: torch.Size([248, 3]), X_test: torch.Size([1000000, 4]), y_test: torch.Size([1000000, 3]), X_global_test: torch.Size([200, 4]), y_global_test: torch.Size([200, 3])
Epoch = 10, Average train loss:      0.27089837
Epoch = 10, Average test loss:      1.47895885
Epoch = 20, Average train loss:      0.14884473
Epoch = 20, Average test loss:      8.83352280
Epoch = 30, Average train loss:      0.07094742
Epoch = 30, Average test loss:     25.53292084
Epoch = 40, Average train loss:      0.04050025
Epoch = 40, Average test loss:     31.45427895
Epoch = 50, Average train loss:      0.02761935
Epoch = 50, Average test loss:     18.42352295
Epoch = 60, Average train loss:      0.02155939
Epoch = 60, Average test loss:     13.10909939
Epoch = 70, Average train loss:      0.01662307
Epoch = 70, Average test loss:      9.74797821
Epoch = 80, Average train loss:      0.01208098
Epoch = 80, Average test loss:      7.43964624
Epoch = 90, Average train loss:      0.00845443
Epoch = 90, Average test loss:      5.59016466
Epoch = 100, Average train loss:      0.00617918
Epoch = 100, Average test loss:      4.89717770
Epoch = 110, Average train loss:      0.00504124
Epoch = 110, Average test loss:      6.13711023
Epoch = 120, Average train loss:      0.00439130
Epoch = 120, Average test loss:      4.91745710
Epoch = 130, Average train loss:      0.00408803
Epoch = 130, Average test loss:      4.78782463
Epoch = 140, Average train loss:      0.00389608
Epoch = 140, Average test loss:      2.95707846
Epoch = 150, Average train loss:      0.00375132
Epoch = 150, Average test loss:      2.71468949
Epoch = 160, Average train loss:      0.00357442
Epoch = 160, Average test loss:      2.48102164
Epoch = 170, Average train loss:      0.00344907
Epoch = 170, Average test loss:      2.38797426
Epoch = 180, Average train loss:      0.00335743
Epoch = 180, Average test loss:      1.95378458
Epoch = 190, Average train loss:      0.00321972
Epoch = 190, Average test loss:      2.12068200
Epoch = 200, Average train loss:      0.00310019
Epoch = 200, Average test loss:      2.54751539
Epoch = 210, Average train loss:      0.00296571
Epoch = 210, Average test loss:      1.56907427
Epoch = 220, Average train loss:      0.00286235
Epoch = 220, Average test loss:      2.24080729
Epoch = 230, Average train loss:      0.00276987
Epoch = 230, Average test loss:      1.43218541
Epoch = 240, Average train loss:      0.00270972
Epoch = 240, Average test loss:      2.30337477
Epoch = 250, Average train loss:      0.00256894
Epoch = 250, Average test loss:      2.05642033
Epoch = 260, Average train loss:      0.00253747
Epoch = 260, Average test loss:      2.22838688
Epoch = 270, Average train loss:      0.00238902
Epoch = 270, Average test loss:      1.99789751
Epoch = 280, Average train loss:      0.00236387
Epoch = 280, Average test loss:      2.32087398
Epoch = 290, Average train loss:      0.00230721
Epoch = 290, Average test loss:      1.36409736
Epoch = 300, Average train loss:      0.00220949
Epoch = 300, Average test loss:      2.03938937
Epoch = 310, Average train loss:      0.00212594
Epoch = 310, Average test loss:      2.04983735
Epoch = 320, Average train loss:      0.00203562
Epoch = 320, Average test loss:      2.25354099
Epoch = 330, Average train loss:      0.00200040
Epoch = 330, Average test loss:      2.06652117
Epoch = 340, Average train loss:      0.00190893
Epoch = 340, Average test loss:      1.57855558
Epoch = 350, Average train loss:      0.00188710
Epoch = 350, Average test loss:      2.26787353
Epoch = 360, Average train loss:      0.00179540
Epoch = 360, Average test loss:      2.03381872
Epoch = 370, Average train loss:      0.00172758
Epoch = 370, Average test loss:      1.72917056
Epoch = 380, Average train loss:      0.00167555
Epoch = 380, Average test loss:      2.31026959
Epoch = 390, Average train loss:      0.00163569
Epoch = 390, Average test loss:      1.65278852
Epoch = 400, Average train loss:      0.00161298
Epoch = 400, Average test loss:      2.07623839
Epoch = 410, Average train loss:      0.00159357
Epoch = 410, Average test loss:      2.97853804
Epoch = 420, Average train loss:      0.00152526
Epoch = 420, Average test loss:      3.16914010
Epoch = 430, Average train loss:      0.00150834
Epoch = 430, Average test loss:      3.17873669
Epoch = 440, Average train loss:      0.00146572
Epoch = 440, Average test loss:      1.94002604
Epoch = 450, Average train loss:      0.00144430
Epoch = 450, Average test loss:      3.04736423
Epoch = 460, Average train loss:      0.00145820
Epoch = 460, Average test loss:      2.15091681
Epoch = 470, Average train loss:      0.00141247
Epoch = 470, Average test loss:      2.16231990
Epoch = 480, Average train loss:      0.00140310
Epoch = 480, Average test loss:      2.13962865
Epoch = 490, Average train loss:      0.00136083
Epoch = 490, Average test loss:      2.32555056
Epoch = 500, Average train loss:      0.00136122
Epoch = 500, Average test loss:      2.24935484
Epoch = 510, Average train loss:      0.00133390
Epoch = 510, Average test loss:      2.25092936
Epoch = 520, Average train loss:      0.00129590
Epoch = 520, Average test loss:      2.61076260
Epoch = 530, Average train loss:      0.00131599
Epoch = 530, Average test loss:      3.35269022
Epoch = 540, Average train loss:      0.00127600
Epoch = 540, Average test loss:      2.76826811
Epoch = 550, Average train loss:      0.00126909
Epoch = 550, Average test loss:      3.40246129
Epoch = 560, Average train loss:      0.00124045
Epoch = 560, Average test loss:      2.70997620
Epoch = 570, Average train loss:      0.00124502
Epoch = 570, Average test loss:      2.46889114
Epoch = 580, Average train loss:      0.00123841
Epoch = 580, Average test loss:      4.05875587
Epoch = 590, Average train loss:      0.00119002
Epoch = 590, Average test loss:      2.50640368
Epoch = 600, Average train loss:      0.00119631
Epoch = 600, Average test loss:      3.90551853
Epoch = 610, Average train loss:      0.00120283
Epoch = 610, Average test loss:      3.03496075
Epoch = 620, Average train loss:      0.00117044
Epoch = 620, Average test loss:      2.63386559
Epoch = 630, Average train loss:      0.00118517
Epoch = 630, Average test loss:      2.69247007
Epoch = 640, Average train loss:      0.00118651
Epoch = 640, Average test loss:      4.07522917
Epoch = 650, Average train loss:      0.00118461
Epoch = 650, Average test loss:      2.81827879
Epoch = 660, Average train loss:      0.00114033
Epoch = 660, Average test loss:      2.78276801
Epoch = 670, Average train loss:      0.00110493
Epoch = 670, Average test loss:      4.80725145
Epoch = 680, Average train loss:      0.00117496
Epoch = 680, Average test loss:      3.43535757
Epoch = 690, Average train loss:      0.00109499
Epoch = 690, Average test loss:      2.99085474
Epoch = 700, Average train loss:      0.00114060
Epoch = 700, Average test loss:      5.21121264
Epoch = 710, Average train loss:      0.00110158
Epoch = 710, Average test loss:      3.94743419
Epoch = 720, Average train loss:      0.00108255
Epoch = 720, Average test loss:      4.24086475
Epoch = 730, Average train loss:      0.00105480
Epoch = 730, Average test loss:      4.30186605
Epoch = 740, Average train loss:      0.00103901
Epoch = 740, Average test loss:      4.56005287
Epoch = 750, Average train loss:      0.00104551
Epoch = 750, Average test loss:      4.73143005
Epoch = 760, Average train loss:      0.00103645
Epoch = 760, Average test loss:      6.21731186
Epoch = 770, Average train loss:      0.00102712
Epoch = 770, Average test loss:      4.29299068
Epoch = 780, Average train loss:      0.00103330
Epoch = 780, Average test loss:      5.06928873
Epoch = 790, Average train loss:      0.00103270
Epoch = 790, Average test loss:      6.78779125
Epoch = 800, Average train loss:      0.00103295
Epoch = 800, Average test loss:      6.89974785
Epoch = 810, Average train loss:      0.00099335
Epoch = 810, Average test loss:      8.29956245
Epoch = 820, Average train loss:      0.00095372
Epoch = 820, Average test loss:      8.36007214
Epoch = 830, Average train loss:      0.00097350
Epoch = 830, Average test loss:      6.02763081
Epoch = 840, Average train loss:      0.00096630
Epoch = 840, Average test loss:      5.32895374
Epoch = 850, Average train loss:      0.00097880
Epoch = 850, Average test loss:      6.52420664
Epoch = 860, Average train loss:      0.00098824
Epoch = 860, Average test loss:      6.86593580
Epoch = 870, Average train loss:      0.00094906
Epoch = 870, Average test loss:      6.01543045
Epoch = 880, Average train loss:      0.00095661
Epoch = 880, Average test loss:      6.00782776
Epoch = 890, Average train loss:      0.00093556
Epoch = 890, Average test loss:      6.40259600
Epoch = 900, Average train loss:      0.00088654
Epoch = 900, Average test loss:      7.94235516
Epoch = 910, Average train loss:      0.00093604
Epoch = 910, Average test loss:      8.06876564
Epoch = 920, Average train loss:      0.00096313
Epoch = 920, Average test loss:     12.26931286
Epoch = 930, Average train loss:      0.00095209
Epoch = 930, Average test loss:     12.54218960
Epoch = 940, Average train loss:      0.00093445
Epoch = 940, Average test loss:     11.43705082
Epoch = 950, Average train loss:      0.00090399
Epoch = 950, Average test loss:      9.49822998
Epoch = 960, Average train loss:      0.00088619
Epoch = 960, Average test loss:      9.82155514
Epoch = 970, Average train loss:      0.00087143
Epoch = 970, Average test loss:      8.86975002
Epoch = 980, Average train loss:      0.00087518
Epoch = 980, Average test loss:      8.88756657
Epoch = 990, Average train loss:      0.00090013
Epoch = 990, Average test loss:      9.21299934
Epoch = 1000, Average train loss:      0.00086684
Epoch = 1000, Average test loss:     14.81904316
Final test: Average loss = 13030.44773158791
[[0.47734216 0.58405781 0.63837624 0.01789129]
 [0.06441645 0.11972064 0.67111373 0.0013869 ]
 [0.94849056 0.17891192 0.56226045 0.68947935]
 ...
 [0.27325782 0.10560723 0.87763017 0.21560533]
 [0.74917722 0.07748792 0.07247264 0.08403853]
 [0.33956346 0.78152966 0.29718885 0.02718654]]
(1000000, 4)
